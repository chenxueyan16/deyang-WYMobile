(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{2154:function(e,n,t){"use strict";var o={uForm:function(){return t.e("uview-ui/components/u-form/u-form").then(t.bind(null,"8393"))},uFormItem:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui/components/u-form-item/u-form-item")]).then(t.bind(null,"2189"))},uInput:function(){return Promise.all([t.e("common/vendor"),t.e("uview-ui/components/u-input/u-input")]).then(t.bind(null,"5771"))},uLoading:function(){return t.e("uview-ui/components/u-loading/u-loading").then(t.bind(null,"73e3"))},uToast:function(){return t.e("uview-ui/components/u-toast/u-toast").then(t.bind(null,"f7c3"))}},i=function(){var e=this,n=e.$createElement,t=(e._self._c,{width:"20px",height:"20px"}),o={width:"20px",height:"20px"};e.$mp.data=Object.assign({},{$root:{a0:t,a1:o}})},u=[];t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return u})),t.d(n,"a",(function(){return o}))},"2efb":function(e,n,t){},"33c6":function(e,n,t){"use strict";(function(e){t("3323"),t("921b");o(t("66fd"));var n=o(t("7dcc"));function o(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},4874:function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=t("31af"),i=Math.random().toString(36).substr(2),u={data:function(){return{show:!1,src:"",msg:"手机号格式有误，请重新输入！",phone:"",code:"",captcha:"",weixinCode:"",testPhone:!1,canClick:!0,seconds:60,canSubmit:!1,content:"发送验证码"}},onLoad:function(){var n=e.getStorageSync("userInfo");if(n){var t=JSON.parse(n).token;this.checkInfo(t)}},onReady:function(){},methods:{getWeixinCode:function(){var n=this;e.login({provider:"weixin",success:function(e){n.weixinCode=e.code}})},requestHandle:function(){var e=this,n=new XMLHttpRequest;n.onload=function(){var n=URL.createObjectURL(this.response),t=document.getElementById(id);e.src=n,t.onload=function(e){window.URL.revokeObjectURL(this.src)}},n.open("POST",o.url),n.setRequestHeader("SPR-ZHSQ-Token",i),n.responseType="blob",n.send(null)},checkInfo:function(n){var t=this;e.request({url:o.url+"app/police/self/info",method:"POST",header:{"SPR-ZHSQ-Token":n},data:JSON.stringify({weixinCode:t.weixinCode}),success:function(e){if(0===e.data.code)t.returnTo();else if(401==e.data.code)return!1}})},verifyHandle:function(){var n=this,t=/^1(3|4|5|7|8|9)\d{9}$/;n.phone=n.phone.replace(/\s+/g,""),t.test(n.phone)?(n.testPhone=!1,e.request({url:o.url+"app/tologin/sendSms",method:"POST",withCredentials:!0,header:{"SPR-ZHSQ-Token":i},data:JSON.stringify({phone:n.phone}),success:function(e){0===e.data.code&&n.count()}})):n.testPhone=!0},count:function(){if(this.canClick){this.canClick=!1,this.content="重新发送("+this.seconds+")秒";var e=this,n=setInterval((function(){e.seconds--,e.content="重新发送("+e.seconds+")秒",e.seconds<0&&(clearInterval(n),e.content="重新发送",e.seconds=60,e.canClick=!0)}),1e3)}},changeValue:function(){""!==this.code&&""!==this.phone?this.canSubmit=!0:this.canSubmit=!1},login:function(){var n=this;if(!n.canSubmit)return!1;n.show=!0,e.request({url:o.url+"app/tologin/login/wy",method:"POST",header:{"SPR-ZHSQ-Token":i},data:JSON.stringify({phone:n.phone,code:n.code,captcha:n.captcha,weixinCode:n.weixinCode}),success:function(t){if(0===t.data.code)try{e.setStorageSync("userInfo",JSON.stringify(t.data.data)),n.switchHandle(t.data.data.token)}catch(o){}else n.show=!1,n.$refs.uToast.show({title:t.data.msg,type:"error"})}})},switchHandle:function(n){var t=this;e.request({url:o.url+"app/zhsquser/aliAuth/switch",method:"POST",header:{"SPR-ZHSQ-Token":n},data:JSON.stringify({roleType:320}),success:function(e){0==e.data.code&&(t.show=!1,t.$refs.uToast.show({title:"登录成功",type:"success",url:"/pages/index/index"}))}})},returnTo:function(){setTimeout((function(){e.navigateTo({url:"../index/index"})}),500)}}};n.default=u}).call(this,t("543d")["default"])},"5dba":function(e,n,t){"use strict";var o=t("2efb"),i=t.n(o);i.a},"7dcc":function(e,n,t){"use strict";t.r(n);var o=t("2154"),i=t("b4c7");for(var u in i)"default"!==u&&function(e){t.d(n,e,(function(){return i[e]}))}(u);t("5dba");var c,a=t("f0c5"),s=Object(a["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],c);n["default"]=s.exports},b4c7:function(e,n,t){"use strict";t.r(n);var o=t("4874"),i=t.n(o);for(var u in o)"default"!==u&&function(e){t.d(n,e,(function(){return o[e]}))}(u);n["default"]=i.a}},[["33c6","common/runtime","common/vendor"]]]);